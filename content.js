keywordForChar = { "一": "One", "二": "Two", "三": "Three", "四": "Four", "五": "Five", "六": "Six", "七": "Seven", "八": "Eight", "九": "Nine", "十": "Ten", "口": "Mouth", "日": "Day", "月": "Month", "田": "Rice Field", "目": "Eye", "古": "Ancient", "胡": "Recklessly", "叶": "Leaf", "朋": "Companion", "明": "Bright", "品": "Goods", "早": "Early", "世": "Generation", "自": "Oneself", "白": "White", "百": "Hundred", "旧": "Old", "中": "Middle", "千": "Thousand", "升": "Liter", "占": "Tell Fortunes", "上": "Above", "下": "Below", "卡": "Card", "朝": "Dynasty", "只": "Only", "员": "Employee", "儿": "Youngster", "几": "How many?", "见": "See", "元": "Beginning", "负": "Defeated", "万": "Ten Thousand", "句": "Sentence", "的": "Bull’s Eye", "首": "Heads", "直": "Straight", "置": "Set Up", "具": "Tool", "真": "TRUE", "工": "Work (n.)", "左": "Left", "右": "Right", "有": "Possess", "项": "Item", "切": "Cut (v.)", "则": "Rule (n.)", "副": "Vice-", "可": "Can", "哥": "Older Brother", "顶": "Crest", "飞": "Fly (v.)", "子": "Child", "乱": "Chaos", "了": "(-ed)", "女": "Woman", "好": "Good", "如": "Be like", "母": "Mother", "克": "Overcome", "小": "Small", "少": "Few", "孙": "Grandchild", "大": "Large", "多": "Many", "够": "Enough", "外": "Outside", "名": "Name (n.)", "罗": "Silk Gauze", "厂": "Factory", "石": "Stone", "光": "Ray", "太": "Overly", "省": "Economize", "奇": "Strange", "州": "State", "顺": "Obey", "水": "Water", "永": "Eternity", "求": "Request (v.)", "原": "Flatlands", "洲": "Continent", "沙": "Sand", "江": "Yangtze", "源": "Source", "活": "Lively", "消": "Extinguish", "河": "River", "鱼": "Fish", "湖": "Lake", "测": "Fathom (v.)", "土": "Soil", "均": "Equal", "压": "Pressure (n.)", "封": "Seal (v.)", "时": "Time", "火": "Fire", "灭": "Destroy", "点": "Spot (n.)", "照": "Illuminate", "里": "Li", "量": "Quantity", "黑": "Black", "同": "Same", "丽": "Lovely", "向": "Orientation", "响": "Echo (n.)", "尚": "Esteem (v.)", "字": "Character", "守": "Guard (v.)", "完": "Finish (v.)", "宣": "Proclaim", "安": "Peaceful", "富": "Wealthy", "木": "Tree", "林": "Woods", "梦": "Dream (n.)", "机": "Machine", "村": "Village", "相": "One another", "本": "Notebook", "案": "Case", "未": "Not yet", "味": "Flavor", "查": "Investigate", "李": "Plum", "杂": "Miscellaneous", "若": "As if", "草": "Grass", "艺": "Technique", "苦": "Suffering", "莫": "Nobody", "模": "Imitate", "状": "State of affairs", "将": "General (military rank)", "获": "Seize", "然": "Sort of thing", "器": "Utensil", "特": "Special", "告": "Declare", "先": "Before", "个": "Individual", "介": "Introduce", "界": "World", "合": "Fit (v.)", "哈": "Ha!", "王": "King", "宝": "Treasure (n.)", "球": "Ball", "现": "Present (adj.)", "皇": "Emperor", "全": "Whole", "理": "Logic", "主": "Lord", "注": "Pour", "金": "Gold", "钟": "Bell", "道": "Way", "达": "Reach (v.)", "远": "Distant", "适": "Suitable", "过": "Cross (v.)", "造": "Create", "逃": "Escape (v.)", "选": "Choose", "车": "Car", "连": "One after another", "前": "In front", "输": "Transport", "条": "Strip (n.)", "处": "Location", "各": "Each", "格": "Pattern", "略": "Abbreviation", "客": "Guest", "额": "Forehead", "洛": "L.A.", "落": "Fall (v.)", "备": "Prepare", "沉": "Profound", "军": "Army", "高": "Tall", "亮": "Shiny", "京": "Capital", "景": "Scenery", "就": "At once", "周": "Circumference", "士": "Soldier", "吉": "Lucky", "学": "Study (v.)", "觉": "Senses", "攻": "Attack", "敌": "Enemy", "败": "Fail", "故": "Deliberately", "救": "Rescue (v.)", "言": "Say", "警": "Police", "计": "Plan (n.)", "让": "Yield", "讨": "Condemn", "识": "Knowledge", "话": "Talk (n.)", "诗": "Poem", "语": "Language", "调": "Tune (n.)", "谈": "Discuss", "式": "Style", "试": "Test", "战": "War", "划": "Scratch (v.)", "或": "Or", "载": "Laden", "成": "Turn into", "城": "City", "威": "Might (n.)", "钱": "Coin", "止": "Stop (v.)", "步": "Footstep", "肯": "Agree", "企": "Look forward to", "武": "Military", "正": "Correct", "证": "Evidence", "政": "Politics", "定": "Settle on", "走": "Walk", "超": "Transcend", "越": "Surpass", "是": "Be", "题": "Topic", "建": "Build", "楚": "Clear (adj.)", "衣": "Clothing", "装": "Attire", "初": "Elementary", "补": "Patch (v.)", "农": "Agriculture", "师": "Teacher", "布": "Cloth", "市": "Market", "带": "Sash", "制": "System", "雨": "Rain", "雷": "Thunder", "云": "Cloud", "运": "Carry", "况": "Situation", "冲": "Collide", "减": "Reduce", "天": "Heavens", "误": "Error", "立": "Standing up", "站": "Station", "章": "Chapter", "帝": "Sovereign", "商": "Salesman", "北": "North", "背": "Back (n.)", "比": "Compare", "此": "This (literary)", "些": "Somewhat", "它": "It", "论": "Theory", "每": "Every", "海": "Sea", "吃": "Eat", "复": "Duplicate (v.)", "次": "Next", "资": "Assets", "音": "Sound", "暗": "Dark", "竟": "Unexpectedly", "境": "Boundary", "亡": "Deceased", "望": "Expect", "方": "Direction", "放": "Release", "激": "Excite", "旁": "Side", "脱": "Undress", "说": "Speak", "曾": "Formerly", "增": "Increase (v.)", "也": "Also", "她": "She", "地": "Ground", "独": "Alone", "虽": "Although", "己": "Self", "起": "Begin", "改": "Alter", "记": "Remember", "已": "Already", "包": "Wrap (v.)", "导": "Guide (v.)", "顾": "Look Back", "逐": "Pursue", "家": "House", "场": "Site", "美": "Beautiful", "洋": "Ocean", "鲜": "Fresh", "样": "Appearance", "兰": "Orchid", "差": "Fall short of", "着": "-ing", "养": "Raise (v.)", "集": "Gather", "准": "Standard (n.)", "谁": "Who?", "许": "Permit (v.)", "习": "Learn", "困": "Trapped", "固": "Solid", "国": "Country", "因": "Cause (n.)", "烟": "Smoke (n.)", "园": "Park (n.)", "回": "Return (v.)", "图": "Picture (n.)", "广": "Extensive", "心": "Heart", "总": "General (adj.)", "态": "Attitude", "志": "Aspiration", "思": "Consider", "恩": "Kindness", "愿": "Wish (n.)", "意": "Idea", "想": "Think", "息": "Breath", "恐": "Fear (v.)", "感": "Feel", "惊": "Startled", "怕": "Dread (v.)", "忙": "Busy", "必": "Certainly", "手": "Hand", "看": "Look at", "拿": "Hold (v.)", "我": "I", "抗": "Combat", "批": "Criticize", "招": "Beckon", "打": "Strike (v.)", "指": "Finger", "持": "Support", "担": "Assume", "括": "Include", "提": "Bring up", "挥": "Brandish", "推": "Push", "执": "Clench", "热": "Heat (n./v.)", "接": "Welcome (v.)", "按": "Press down on", "掉": "Drop (v.)", "拉": "Pull", "找": "Look for", "无": "Nothing", "开": "Open (v.)", "研": "Grind away", "异": "Different", "型": "Mold (v.)", "才": "Genius", "财": "Riches", "团": "Troupe", "存": "Deposit (v.)", "在": "At", "及": "Catch up with", "吸": "Inhale", "极": "Extreme (n.)", "史": "History", "更": "Even more", "又": "Again", "圣": "Holy", "友": "Friend", "双": "Pair", "汉": "Han", "观": "Observe", "欢": "Joyous", "怪": "Peculiar", "对": "That's right", "树": "Timber", "难": "Difficult", "投": "Throw (v.)", "没": "Not have", "设": "Establish", "股": "Thigh", "支": "Offshoot", "技": "Skill", "督": "Superintend", "反": "Against", "板": "Plank", "后": "Behind", "质": "Quality", "派": "Faction", "乐": "Music", "抓": "Grab", "采": "Pick (v.)", "受": "Accept", "授": "Confer", "爱": "Love (n./v.)", "么": "(suffix)", "台": "Platform", "治": "Govern", "始": "Commence", "去": "Go", "法": "Method", "会": "Meeting", "至": "Until", "室": "Room", "到": "Arrive", "互": "Mutual", "充": "Sufficient", "育": "Education", "流": "Flow (v.)", "构": "Frame (v.)", "山": "Mountain", "出": "Exit (v.)", "岁": "Years of age", "密": "Secret (adj.)", "入": "Enter", "分": "Part (n./v.)", "公": "Public", "松": "Pine Tree", "容": "Contain", "党": "Political Party", "常": "Often", "堂": "Main Room", "皮": "Covering", "波": "Waves", "破": "Break (v.)", "被": "Quilt (n.)", "列": "Line up", "烈": "Intense", "死": "Death", "耳": "Ear", "取": "Take", "最": "Most", "职": "Job", "敢": "Brave", "慢": "Slow", "夫": "Husband", "规": "Regulations", "失": "Lose", "铁": "Iron", "力": "Power", "边": "Border", "势": "Force (n.)", "动": "Move", "历": "Experience (n./v.)", "另": "Another", "别": "Don’t", "男": "Male", "功": "Achievement", "办": "Manage", "协": "Cooperate", "苏": "Revive", "为": "Act (v.)", "加": "Add", "架": "Shelf", "务": "Tasks", "行": "Line of business", "律": "Law", "得": "Must", "待": "Treat (v.)", "往": "Toward", "微": "Tiny", "德": "Morality", "程": "Journey (n.)", "和": "Harmony", "积": "Accumulate", "种": "Species", "移": "Shift (v.)", "利": "Profit (n.)", "香": "Perfume", "委": "Committee", "米": "Rice", "类": "Kind (n.)", "来": "Come", "数": "Number", "楼": "Multistory building", "笑": "Laugh (v.)", "等": "Etc.", "算": "Calculate", "答": "Answer (v.)", "策": "Strategy", "人": "Person", "认": "Recognize", "价": "Price", "份": "Portion", "尔": "You (literary)", "你": "You", "您": "You (respectful)", "称": "Weigh", "什": "What?", "值": "Value (n.)", "做": "Make", "但": "However", "住": "Dwell", "位": "Position (n.)", "件": "Piece", "仍": "Still", "他": "He", "仅": "Merely", "体": "Body", "信": "Faith", "依": "Depend on", "例": "Example", "健": "Healthy", "停": "Halt", "倒": "Upside down", "优": "Excellent", "伤": "Wound (n.)", "保": "Safeguard", "付": "Pay (v.)", "府": "Government office", "代": "Substitute for", "化": "Transform", "华": "Splendor", "花": "Flower (n.)", "货": "Commodities", "何": "Whatwhichwhowherewhy?", "便": "Convenient", "使": "Use", "久": "Long time", "内": "Internal", "从": "Follow", "众": "Multitude", "坐": "Sit", "座": "Seat", "喝": "Drink (v.)", "任": "Appoint", "庭": "Court of law", "头": "Head", "实": "Reality", "买": "Buy", "卖": "Sell", "读": "Read", "以": "By means of", "似": "Similar", "并": "Combine", "荣": "Glory", "劳": "Labor (n.)", "营": "Camp (n.)", "善": "Virtuous", "年": "Year", "夜": "Night", "旅": "Travel (v.)", "施": "Execute", "游": "Go swimming", "忽": "Suddenly", "物": "Thing", "易": "Easy", "尼": "Nun", "呢": "Woolen cloth", "屋": "Habitation", "居": "Reside", "剧": "Drama", "据": "Certificate", "层": "Story", "局": "Bureau", "尽": "Exhausted", "户": "Door", "房": "Domicile", "护": "Protect", "示": "Show (v.)", "社": "Society", "礼": "Ceremony", "视": "Inspect", "福": "Happiness", "标": "Mark (n.)", "禁": "Prohibit", "宗": "Religion", "察": "Scrutinize", "由": "Wherefore", "油": "Oil", "神": "Gods", "果": "Fruit", "听": "Listen", "所": "Place (n.)", "近": "Near", "渐": "Gradually", "断": "Sever", "诉": "Accuse", "怎": "How?", "作": "Do", "灵": "Spirit", "妇": "Married woman", "寻": "Seek", "急": "Anxious", "当": "Work as", "录": "Record (v.)", "争": "Contend", "事": "Matter", "唐": "Tang", "康": "Hale", "伊": "Queen Elizabeth", "君": "Monarch", "群": "Crowd (n.)", "而": "And", "需": "Need (v.)", "端": "Upright", "斗": "Big Dipper", "料": "Material", "科": "Academic Discipline", "借": "Borrow", "错": "Mistaken", "散": "Scattered", "席": "Mat", "度": "Degrees", "半": "Half", "判": "Judge (v.)", "片": "Slice (n.)", "版": "Printing plate", "之": "Of", "不": "No", "否": "Negate", "坏": "Bad", "环": "Ring", "还": "Give back", "怀": "Cherish", "族": "Tribe", "知": "Know", "智": "Wisdom", "予": "Bestow", "序": "Preface (n.)", "预": "Beforehand", "野": "Wild", "班": "Class", "临": "Be about to", "坚": "Firm (adj.)", "引": "Draw", "强": "Strong", "单": "List (n.)", "弹": "Bullet", "费": "Expense", "佛": "Buddha", "弟": "Younger brother", "第": "No.", "号": "Appellation", "身": "Somebody", "射": "Shoot", "谢": "Thank", "老": "Old man", "考": "Take an exam", "与": "Offer", "写": "Write", "教": "Teach", "者": "Someone", "著": "Author (v.)", "追": "Chase", "官": "Bureaucrat", "管": "Pipe", "父": "Father", "交": "Mingle", "效": "Effect (n.)", "较": "Relatively", "校": "School", "足": "Lower leg", "跑": "Run", "跳": "Jump (v.)", "路": "Path", "露": "Dew", "阿": "Apollo", "啊": "Aah!", "随": "As you wish", "阳": "Yang", "阴": "Yin", "防": "Ward off", "附": "Attach", "际": "Occasion", "阶": "Stairs", "院": "Inst.", "阵": "Battle formation", "队": "Team", "降": "Descend", "究": "Research", "突": "Abruptly", "空": "Empty", "控": "Control (v.)", "深": "Deep", "探": "Spy (n.)", "兵": "Troops", "织": "Weave (v.)", "线": "Line", "维": "Maintain", "统": "continuum", "给": "Give", "结": "Tie (v.)", "终": "End (n.)", "级": "Rank (n.)", "纪": "Epoch", "红": "Red", "约": "Make an appointment", "细": "Fine (adj.)", "经": "Scripture", "轻": "Lightweight", "续": "Continue", "继": "Carry on", "药": "Medicine", "系": "Lineage", "紧": "Tight", "却": "Withdraw", "脚": "Foot", "服": "Apparel", "报": "Newspaper", "命": "Fate", "留": "Stay (v.)", "节": "Holiday", "卫": "Defend", "令": "Orders", "冷": "Cold", "领": "Collar", "通": "Communicate", "枪": "Gun", "创": "Initiate", "犯": "Criminal", "危": "Danger", "印": "Print (n./v.)", "酒": "Liquor", "配": "Distribute", "短": "Short", "喜": "Joyful", "血": "Blood", "温": "Temperature", "监": "Supervise", "银": "Silver", "跟": "Heel", "很": "Very", "根": "Root", "即": "Immediately", "退": "Retreat", "限": "Limit (n./v.)", "眼": "Eyelet", "良": "High-quality", "娘": "Mom", "食": "Food", "饭": "Meal", "既": "Since", "概": "Approximate", "平": "Even", "评": "Evaluate", "乎": "Ooh!", "呼": "Shout (v.)", "希": "Hope (v.)", "杀": "Kill", "风": "Wind", "刚": "Just now", "网": "Net", "画": "Drawing", "脑": "Brain", "离": "Leave (v.)", "义": "Righteousness", "议": "Deliberate (v.)", "避": "Evade", "亲": "Relatives", "新": "New", "幸": "Good fortune", "叫": "Call (v.)", "收": "Receive", "核": "Nucleus", "孩": "Tot", "刻": "Carve", "该": "Should", "术": "Art", "述": "Narrate", "毒": "Poison (n.)", "素": "Vegetarian diet", "青": "Blue or green", "精": "Refined", "请": "Invite", "情": "Feelings", "睛": "Eyeball", "清": "Pure", "静": "Quiet", "责": "Responsibility", "表": "Surface (n.)", "生": "Life", "星": "Star", "性": "Sex", "胜": "Victory", "害": "Harm (n.)", "围": "Surround", "春": "Springtime", "击": "Beat (v.)", "陆": "Land", "专": "Specialty", "传": "Spread (v.)", "转": "Rotate", "睡": "Sleep", "今": "Now", "含": "Harbor (v.)", "念": "Miss (v.)", "东": "East", "陈": "Exhibit (v.)", "西": "West", "要": "Want", "票": "Ticket", "南": "South", "门": "Gate", "们": "(plural)", "问": "Ask", "间": "Interval", "简": "Simple", "闻": "Hear", "非": "Non-", "排": "Row", "罪": "Guilt", "靠": "Lean on", "候": "Wait (v.)", "决": "Decide", "快": "Fast (adj.)", "块": "Lump", "干": "Dry (adj.)", "岸": "Shore", "赶": "Hurry", "于": "Yu", "余": "Excess", "除": "Eliminate", "束": "Bundle up", "速": "Quick", "整": "Entire", "重": "Heavy", "病": "Illness", "痛": "Ache (v.)", "区": "Region", "欧": "Europe", "医": "Physician", "登": "Ascend", "发": "Send out", "形": "Shape (n.)", "影": "Shadow", "须": "Have to", "参": "Participate", "修": "Repair (v.)", "产": "Products", "文": "Literature", "这": "This", "济": "Relieve", "率": "Rate (n.)", "央": "Center", "英": "England", "换": "Exchange (v.)", "巴": "Crust", "把": "Grasp (v.)", "吧": "Bar (n.)", "色": "Color", "绝": "Discontinue", "某": "Such and such", "其": "His-hers-its-theirs", "期": "Period of time", "基": "Base (n.)", "甚": "Tremendously", "斯": "Sphinx", "贵": "Expensive", "遗": "Bequeath", "且": "Moreover", "姐": "Older sister", "组": "Group (n.)", "助": "Assist (v.)", "普": "Universal", "业": "Profession", "显": "Obvious", "亚": "Asia", "恶": "Evil (n./v.)", "严": "Strict", "共": "Together", "供": "Supply (n. / v.)", "港": "Port", "讲": "Lecture (v.)", "进": "Advance (v.)", "用": "Utilize", "角": "Angle", "确": "Reliable", "解": "Untie", "再": "Once more", "编": "Compile", "婚": "Marriage", "低": "Low", "底": "Bottom", "民": "People", "博": "Knowledgeable", "都": "Metropolis", "部": "Department", "帮": "Help (v.)", "乡": "Countryside", "段": "Section (n.)", "司": "Take charge of", "词": "Word", "书": "Book", "船": "Ship (n.)", "般": "Sort (n.)", "益": "Benefit (n.)", "假": "Vacation", "气": "Air", "面": "Face-to-face", "革": "Leather", "勒": "Tighten", "声": "Voice", "承": "Undertake", "牙": "Tooth", "穿": "Pass through", "呀": "Wow!", "释": "Explain", "毛": "Fur", "笔": "Pen", "托": "Entrust", "展": "Unfold", "长": "Long", "张": "Stretch (v.)", "应": "Ought to", "兴": "Excitement", "举": "Lift up", "检": "Examine", "脸": "Face (n.)", "险": "Perilous", "岛": "Island", "遇": "Encounter (v.)", "缺": "Deficient", "摇": "Shake (v.)", "免": "Avoid", "晚": "Nightfall", "象": "Elephant", "像": "Likeness", "马": "Horse", "妈": "Mama", "吗": "Yes or no", "验": "Check (v.)", "虑": "Ponder", "能": "Ability", "演": "Perform", "关": "Shut", "送": "Deliver", "联": "Unite", "龙": "Dragon", "那": "That", "哪": "Which?", "两": "Dos", "满": "Full", "县": "County", "电": "Electricity", "黄": "Yellow", "亦": "Likewise", "湾": "Bay", "变": "Change (v.)", "属": "Belong to", "姑": "father's sister", "鲁": "Lu", "宋": "Song (surname)", "销": "put up for sale", "谓": "meaning", "诺": "promise (n.)", "域": "domain", "炮": "cannon", "损": "damage (v.)", "材": "stuff (n.)", "权": "authority", "致": "bring about", "掌": "palm of the hand", "藏": "hide (v.)", "征": "solicit", "税": "tax", "秘": "confidential", "奥": "of great depth", "伯": "father's older brother", "伦": "human relationships", "俄": "Russia", "宫": "palace", "款": "funds", "审": "painstaking", "炸": "blow up", "归": "come back", "纳": "let in", "索": "large rope", "疑": "doubt (v.)", "范": "model", "顿": "pause (n./v.)", "泽": "swamp (n.)", "择": "select (v.)", "疗": "cure (v.)", "巨": "gigantic", "刘": "Liu", "谋": "scheme (v.)", "舰": "warship", "航": "navigate", "毫": "milli-", "剑": "saber"};

function markKnownCharacters(element) {
    for (var child = element.firstChild; child !== null; child = child.nextSibling) {
        if (child.nodeType === 3) { // text node
            // Get the first known character in the node.
            var text = child.data;
            var keyword = null;
            var firstKnownIndex = -1;
            for (var i = 0; i < text.length; i++) {
                var char = text[i];
                keyword = keywordForChar[char];
                if (keyword !== undefined) {
                    firstKnownIndex = i;
                    break;
                }
            }
            if (keyword === undefined) {
                continue;
            }
            // Split the current node if needed.
            var knownCharacterNode = child.splitText(firstKnownIndex);
            // Split the suffix if needed.
            if (i != text.length - 1) {
               knownCharacterNode.splitText(1);
            }

            // Create a span node to replace the current node.
            var spanNode = document.createElement('span');
            // Show an underline under the character.
            spanNode.className = 'marked';
            // Show the associated RRTH keyword when you hover over the character.
            spanNode.setAttribute("title", keyword);

            // Clone the current node that contains the known character, and put it into the span node.
            var knownCharacterNodeClone = knownCharacterNode.cloneNode(true);
            spanNode.appendChild(knownCharacterNodeClone);

            // Replace the known character node with the created span node.
            knownCharacterNode.replaceWith(spanNode);

            // Skip over the node we created
            child = spanNode;
        } else if (child.nodeType === 1) {
            markKnownCharacters(child);
        }
    }
}

const span_style=`
.marked {
  position: relative;
}

.marked:after {
  content: '';
  position: absolute;
  left: 5%;
  width: 90%;
  display: block;
  height: 1px;
  background-color: #89CFF0;
}
`;

function addMarkedStyleCSS() {
    var sheet = document.createElement('style')
    sheet.innerHTML = span_style;
    document.body.appendChild(sheet);
}

addMarkedStyleCSS();
markKnownCharacters(document.body);